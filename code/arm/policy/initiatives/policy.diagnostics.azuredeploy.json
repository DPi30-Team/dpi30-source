{
  "$schema": "https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {},
  "variables": {
    "singleQuote": "'",
    "logAnalytics": "[concat('[parameters(', variables('singleQuote'), 'logAnalytics', variables('singleQuote'), ')]')]",
    "resourceName": "[concat('[parameters(', variables('singleQuote'), 'resourceName', variables('singleQuote'), ')]')]",
    "resourceDiagName": "[concat('[concat(', 'parameters(', variables('singleQuote'), 'resourceName', variables('singleQuote'), ')', ', ', variables('singleQuote'), '/', variables('singleQuote'), ', ', variables('singleQuote'), 'Microsoft.Insights/setByPolicy', variables('singleQuote'), ')]')]",
    "resourceNameField": "[concat('[field(', variables('singleQuote'), 'name', variables('singleQuote'), ')]')]",
    "resourceFullNameField": "[concat('[field(', variables('singleQuote'), 'fullName', variables('singleQuote'), ')]')]",
    "location": "[concat('[parameters(', variables('singleQuote'), 'location', variables('singleQuote'), ')]')]",
    "locationField": "[concat('[field(', variables('singleQuote'), 'location', variables('singleQuote'), ')]')]",
    "policyDescription": "This afc policy automatically deploys and enables Diagnostic Settings to Log Analytics",
    "nicafcDiagPolicyName": "afc-audit-nic-diagnostic-settings",
    "aaafcDiagPolicyName": "afc-audit-automationaccount-diagnostic-settings",
    "pipafcDiagPolicyName": "afc-audit-publicip-diagnostic-settings",
    "lbafcDiagPolicyName": "afc-audit-loadbalancer-diagnostic-settings",
    "nsgafcDiagPolicyName": "afc-audit-networksecuritygroup-diagnostic-settings",
    "kvafcDiagPolicyName": "afc-audit-keyvault-diagnostic-settings",
    "cognitiveafcDiagPolicyName": "afc-audit-cognitive-diagnostic-settings",
    "dataLakeAnalyticsafcDiagPolicyName": "afc-audit-datalakealanalytics-diagnostic-settings",
    "dataLakeStoreafcDiagPolicyName": "afc-audit-datalakestore-diagnostic-settings",
    "eventHubafcDiagPolicyName": "afc-audit-eventhub-diagnostic-settings",
    "iotHubafcDiagPolicyName": "afc-audit-iothub-diagnostic-settings",
    "logicAppsWorkflowafcDiagPolicyName": "afc-audit-logicapps-workflow-diagnostic-settings",
    "logicAppsIntegrationAccountsafcDiagPolicyName": "afc-audit-logicApps-integrationaccount-diagnostic-settings",
    "recoveryVaultafcDiagPolicyName": "afc-audit-recoveryvault-diagnostic-settings",
    "searchServicesafcDiagPolicyName": "afc-audit-searchservices-diagnostic-settings",
    "serviceBusafcDiagPolicyName": "afc-audit-servicebus-diagnostic-settings",
    "sqlDBsafcDiagPolicyName": "afc-audit-sqldb-diagnostic-settings",
    "sqlElasticPoolsafcDiagPolicyName": "afc-audit-sqlelasticpools-diagnostic-settings",
    "sqlMIafcDiagPolicyName": "afc-audit-sqlmanagedinstance-diagnostic-settings",
    "apiMgmtafcDiagPolicyName": "afc-audit-apimgmt-diagnostic-settings",
    "appGwafcDiagPolicyName": "afc-audit-appgateway-diagnostic-settings",
    "batchafcDiagPolicyName": "afc-audit-batch-diagnostic-settings",
    "mySQLafcDiagPolicyName": "afc-audit-mysql-diagnostic-settings",
    "postgreSQLafcDiagPolicyName": "afc-audit-postgresql-diagnostic-settings",
    "cdnEndpointsafcDiagPolicyName": "afc-audit-cdnendpoints-diagnostic-settings",
    "cosmosDBsafcDiagPolicyName": "afc-audit-cosmosdb-diagnostic-settings",
    "dataFactoryafcDiagPolicyName": "afc-audit-datafactory-diagnostic-settings",
    "firewallafcDiagPolicyName": "afc-audit-firewall-diagnostic-settings",
    "powerBIEmbeddedafcDiagPolicyName": "afc-audit-powerbiembedded-diagnostic-settings",
    "streamAnalyticsafcDiagPolicyName": "afc-audit-streamanalytics-diagnostic-settings",
    "expressRoutesafcDiagPolicyName": "afc-audit-expressroutes-diagnostic-settings",
    "aciafcDiagPolicyName": "afc-audit-containergroup-diagnostic-settings",
    "acrafcDiagPolicyName": "afc-audit-containerregistry-diagnostic-settings",
    "vnetafcDiagPolicyName": "afc-audit-vnet-diagnostic-settings",
    "vmafcDiagPolicyName": "afc-audit-virtualmachine-diagnostic-settings",
    "vmssafcDiagPolicyName": "afc-audit-virtualmachine-scaleset-diagnostic-settings",
    "vnetGWafcDiagPolicyName": "afc-audit-vnetgateway-diagnostic-settings",
    "aksafcDiagPolicyName": "afc-audit-aks-diagnostic-settings",
    "websiteafcDiagPolicyName": "afc-audit-website-diagnostic-settings",
    "webServerFarmafcDiagPolicyName": "afc-audit-webserverfarm-diagnostic-settings",
    "analysisServiceafcDiagPolicyName": "afc-audit-analysisservice-diagnostic-settings",
    "eventGridTopicafcDiagPolicyName": "afc-audit-eventgridtopic-diagnostic-settings",
    "eventGridSubafcDiagPolicyName": "afc-audit-eventgridsub-diagnostic-settings",
    "hdInsightafcDiagPolicyName": "afc-audit-hdinsight-diagnostic-settings",
    "redisCacheafcDiagPolicyName": "afc-audit-rediscache-diagnostic-settings",
    "relayafcDiagPolicyName": "afc-audit-relay-diagnostic-settings",
    "signalRafcDiagPolicyName": "afc-audit-signalr-diagnostic-settings",
    "trafficManagerafcDiagPolicyName": "afc-audit-trafficmanager-diagnostic-settings",
    "timeSeriesInsightsafcDiagPolicyName": "afc-audit-timeseriesinsights-diagnostic-settings",
    "diagafcInitiativeName": "afc-diagnostic-settings-Initiative",
    "defaultafcInitiativeName": "afc-baseline-Initiative"
  },
  "resources": [
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('nicafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Network Interfaces",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Network/networkInterfaces"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Network/networkInterfaces/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "timeGrain": null,
                              "enabled": true,
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('aaafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('nicafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Azure Automation Accounts",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Automation/automationAccounts"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Automation/automationAccounts/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "timeGrain": null,
                              "enabled": true,
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": [
                            {
                              "category": "JobLogs",
                              "enabled": true
                            },
                            {
                              "category": "JobStreams",
                              "enabled": true
                            },
                            {
                              "category": "DscNodeStatus",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('pipafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('aaafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Public IPs",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Network/publicIPAddresses"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Network/publicIPAddresses/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "timeGrain": null,
                              "enabled": true,
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": [
                            {
                              "category": "DDoSProtectionNotifications",
                              "enabled": true
                            },
                            {
                              "category": "DDoSMitigationFlowLogs",
                              "enabled": true
                            },
                            {
                              "category": "DDoSMitigationReports",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('lbafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('pipafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Load Balancers",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Network/loadBalancers"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Network/loadBalancers/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "timeGrain": null,
                              "enabled": true,
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": [
                            {
                              "category": "LoadBalancerAlertEvent",
                              "enabled": true
                            },
                            {
                              "category": "LoadBalancerProbeHealthStatus",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('nsgafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('lbafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Network Security Groups",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Network/networkSecurityGroups"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Network/networkSecurityGroups/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [],
                          "logs": [
                            {
                              "category": "NetworkSecurityGroupEvent",
                              "enabled": true
                            },
                            {
                              "category": "NetworkSecurityGroupRuleCounter",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('kvafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('nsgafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Key Vaults",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.KeyVault/vaults"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.KeyVault/vaults/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "AuditEvent",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('cognitiveafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('kvafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Cognitive Services",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.CognitiveServices/accounts"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.CognitiveServices/accounts/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "Audit",
                              "enabled": true
                            },
                            {
                              "category": "RequestResponse",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('dataLakeAnalyticsafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('cognitiveafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Data Lake Analytics",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.DataLakeAnalytics/accounts"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.DataLakeAnalytics/accounts/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "Audit",
                              "enabled": true
                            },
                            {
                              "category": "Requests",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('dataLakeStoreafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('dataLakeAnalyticsafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Data Lake Storage",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.DataLakeStore/accounts"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.DataLakeStore/accounts/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "Audit",
                              "enabled": true
                            },
                            {
                              "category": "Requests",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('eventHubafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('dataLakeStoreafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Event Hub Namespaces",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.EventHub/namespaces"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.EventHub/namespaces/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "ArchiveLogs",
                              "enabled": true
                            },
                            {
                              "category": "OperationalLogs",
                              "enabled": true
                            },
                            {
                              "category": "AutoScaleLogs",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('iotHubafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('eventHubafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for IoT Hubs",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Devices/IotHubs"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Devices/IotHubs/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "Connections",
                              "enabled": true
                            },
                            {
                              "category": "DeviceTelemetry",
                              "enabled": true
                            },
                            {
                              "category": "C2DCommands",
                              "enabled": true
                            },
                            {
                              "category": "DeviceIdentityOperations",
                              "enabled": true
                            },
                            {
                              "category": "FileUploadOperations",
                              "enabled": true
                            },
                            {
                              "category": "Routes",
                              "enabled": true
                            },
                            {
                              "category": "D2CTwinOperations",
                              "enabled": true
                            },
                            {
                              "category": "C2DTwinOperations",
                              "enabled": true
                            },
                            {
                              "category": "TwinQueries",
                              "enabled": true
                            },
                            {
                              "category": "JobsOperations",
                              "enabled": true
                            },
                            {
                              "category": "DirectMethods",
                              "enabled": true
                            },
                            {
                              "category": "E2EDiagnostics",
                              "enabled": true
                            },
                            {
                              "category": "Configurations",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('logicAppsWorkflowafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('iotHubafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Logic Apps workflows",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Logic/workflows"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Logic/workflows/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "WorkflowRuntime",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('logicAppsIntegrationAccountsafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('logicAppsWorkflowafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Logic Apps Integration Accounts",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Logic/integrationAccounts"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Logic/integrationAccounts/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [],
                          "logs": [
                            {
                              "category": "IntegrationAccountTrackingEvents",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('recoveryVaultafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('logicAppsIntegrationAccountsafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Recovery Vaults",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.RecoveryServices/vaults"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.RecoveryServices/vaults/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [],
                          "logs": [
                            {
                              "category": "AzureBackupReport",
                              "enabled": true
                            },
                            {
                              "category": "AzureSiteRecoveryJobs",
                              "enabled": true
                            },
                            {
                              "category": "AzureSiteRecoveryEvents",
                              "enabled": true
                            },
                            {
                              "category": "AzureSiteRecoveryReplicatedItems",
                              "enabled": true
                            },
                            {
                              "category": "AzureSiteRecoveryReplicationStats",
                              "enabled": true
                            },
                            {
                              "category": "AzureSiteRecoveryRecoveryPoints",
                              "enabled": true
                            },
                            {
                              "category": "AzureSiteRecoveryReplicationDataUploadRate",
                              "enabled": true
                            },
                            {
                              "category": "AzureSiteRecoveryProtectedDiskDataChurn",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('searchServicesafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('recoveryVaultafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Search Services",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Search/searchServices"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Search/searchServices/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "OperationLogs",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('serviceBusafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('searchServicesafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Service Bus namespaces",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.ServiceBus/namespaces"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.ServiceBus/namespaces/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "OperationalLogs",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('sqlDBsafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('serviceBusafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for SQL Databases",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Sql/servers/databases"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Sql/servers/databases/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "SQLInsights",
                              "enabled": true
                            },
                            {
                              "category": "AutomaticTuning",
                              "enabled": true
                            },
                            {
                              "category": "QueryStoreRuntimeStatistics",
                              "enabled": true
                            },
                            {
                              "category": "QueryStoreWaitStatistics",
                              "enabled": true
                            },
                            {
                              "category": "Errors",
                              "enabled": true
                            },
                            {
                              "category": "DatabaseWaitStatistics",
                              "enabled": true
                            },
                            {
                              "category": "Timeouts",
                              "enabled": true
                            },
                            {
                              "category": "Blocks",
                              "enabled": true
                            },
                            {
                              "category": "Deadlocks",
                              "enabled": true
                            },
                            {
                              "category": "Audit",
                              "enabled": true
                            },
                            {
                              "category": "SQLSecurityAuditEvents",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceFullNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('sqlElasticPoolsafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('sqlDBsafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for SQL Elastic Pools",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Sql/servers/elasticPools"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Sql/servers/elasticPools/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": []
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceFullNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('apiMgmtafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('sqlElasticPoolsafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for API Management services",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.ApiManagement/service"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.ApiManagement/service/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "Gateway Requests",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            },
                            {
                              "category": "Capacity",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            },
                            {
                              "category": "EventHub Events",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "GatewayLogs",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('appGwafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('apiMgmtafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Application Gateways",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Network/applicationGateways"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Network/applicationGateways/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "ApplicationGatewayAccessLog",
                              "enabled": true
                            },
                            {
                              "category": "ApplicationGatewayPerformanceLog",
                              "enabled": true
                            },
                            {
                              "category": "ApplicationGatewayFirewallLog",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('batchafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('appGwafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Azure Batch accounts",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Batch/batchAccounts"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Batch/batchAccounts/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "ServiceLog",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('mySQLafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('batchafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for MySQL Databases",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.DBforMySQL/servers"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.DBforMySQL/servers/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "MySqlSlowLogs",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('postgreSQLafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('mySQLafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for PostgreSQL Databases",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.DBforPostgreSQL/servers"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.DBforPostgreSQL/servers/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "PostgreSQLLogs",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('cdnEndpointsafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('postgreSQLafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for CDN Endpoints",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Cdn/profiles/endpoints"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Cdn/profiles/endpoints/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [],
                          "logs": [
                            {
                              "category": "CoreAnalytics",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceFullNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('cosmosDBsafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('cdnEndpointsafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Cosmos DB",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.DocumentDB/databaseAccounts"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.DocumentDB/databaseAccounts/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "Requests",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "DataPlaneRequests",
                              "enabled": true
                            },
                            {
                              "category": "MongoRequests",
                              "enabled": true
                            },
                            {
                              "category": "QueryRuntimeStatistics",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('dataFactoryafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('cosmosDBsafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Data Factory",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.DataFactory/factories"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.DataFactory/factories/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "ActivityRuns",
                              "enabled": true
                            },
                            {
                              "category": "PipelineRuns",
                              "enabled": true
                            },
                            {
                              "category": "TriggerRuns",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('firewallafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('dataFactoryafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Azure Firewalls",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Network/azureFirewalls"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Network/azureFirewalls/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "AzureFirewallApplicationRule",
                              "enabled": true
                            },
                            {
                              "category": "AzureFirewallNetworkRule",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('powerBIEmbeddedafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('firewallafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Power BI Embedded",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.PowerBIDedicated/capacities"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.PowerBIDedicated/capacities/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "Engine",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('streamAnalyticsafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('powerBIEmbeddedafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Stream Analytics",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.StreamAnalytics/streamingjobs"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.StreamAnalytics/streamingjobs/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "Execution",
                              "enabled": true
                            },
                            {
                              "category": "Authoring",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('expressRoutesafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('streamAnalyticsafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Express Routes Circuits",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Network/expressRouteCircuits"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Network/expressRouteCircuits/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "PeeringRouteLog",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('aciafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('expressRoutesafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Azure Container Instances",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.ContainerInstance/containerGroups"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.ContainerInstance/containerGroups/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": []
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('acrafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('aciafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Azure Container Registries",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.ContainerRegistry/registries"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.ContainerRegistry/registries/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": []
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('vnetafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('acrafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Virtual Networks",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Network/virtualNetworks"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Network/virtualNetworks/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [],
                          "logs": [
                            {
                              "category": "VMProtectionAlerts",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('vmafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('vnetafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Virtual Machines",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Compute/virtualMachines"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Compute/virtualMachines/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": []
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('vmssafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('vmafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Virtual Machine Scale Sets",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Compute/virtualMachineScaleSets"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Compute/virtualMachineScaleSets/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": []
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('vnetGWafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('vmssafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Virtual Network Gateways",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Network/virtualNetworkGateways"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Network/virtualNetworkGateways/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "GatewayDiagnosticLog",
                              "enabled": true
                            },
                            {
                              "category": "IKEDiagnosticLog",
                              "enabled": true
                            },
                            {
                              "category": "P2SDiagnosticLog",
                              "enabled": true
                            },
                            {
                              "category": "RouteDiagnosticLog",
                              "enabled": true
                            },
                            {
                              "category": "RouteDiagnosticLog",
                              "enabled": true
                            },
                            {
                              "category": "TunnelDiagnosticLog",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('aksafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('vnetGWafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Azure Kubernetes Service",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.ContainerService/managedClusters"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.ContainerService/managedClusters/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "guard",
                              "enabled": true
                            },
                            {
                              "category": "kube-apiserver",
                              "enabled": true
                            },
                            {
                              "category": "kube-controller-manager",
                              "enabled": true
                            },
                            {
                              "category": "kube-scheduler",
                              "enabled": true
                            },
                            {
                              "category": "cluster-autoscaler",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('websiteafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('aksafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Azure Web Sites",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Web/sites"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Web/sites/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": []
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('analysisServiceafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('websiteafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Azure Analysis Services",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.AnalysisServices/servers"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.AnalysisServices/servers/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "Engine",
                              "enabled": true
                            },
                            {
                              "category": "Service",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('eventGridTopicafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('analysisServiceafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Event Grid Topics",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.EventGrid/topics"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.EventGrid/topics/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": []
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('eventGridSubafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('eventGridTopicafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Event Grid Subscriptions",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.EventGrid/eventSubscriptions"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.EventGrid/eventSubscriptions/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": []
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('hdInsightafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('eventGridSubafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for HDInsight",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.HDInsight/clusters"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.HDInsight/clusters/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": []
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('redisCacheafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('hdInsightafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Redis Cache",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Cache/redis"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Cache/redis/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": []
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('relayafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('redisCacheafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Azure Relay",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Relay/namespaces"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Relay/namespaces/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": []
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('signalRafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('relayafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for SignalR",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.SignalRService/SignalR"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.SignalRService/SignalR/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": []
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('trafficManagerafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('signalRafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Azure Traffic Manager",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Network/trafficManagerProfiles"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Network/trafficManagerProfiles/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": [
                            {
                              "category": "ProbeHealthStatusEvents",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('webServerFarmafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('trafficManagerafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Azure App Service Plans",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Web/serverfarms"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Web/serverfarms/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": []
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('sqlMIafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('webServerFarmafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for SQL Managed Instances",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.Sql/managedInstances"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Sql/managedInstances/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "logs": [
                            {
                              "category": "ResourceUsageStats",
                              "enabled": true
                            },
                            {
                              "category": "SQLSecurityAuditEvents",
                              "enabled": true
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "name": "[variables('timeSeriesInsightsafcDiagPolicyName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('sqlMIafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Time Series Insights",
        "description": "[variables('policyDescription')]",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "mode": "all",
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyRule": {
          "if": {
            "field": "type",
            "equals": "Microsoft.TimeSeriesInsights/environments"
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "name": "setByPolicy",
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "resourceName": {
                        "type": "string"
                      },
                      "logAnalytics": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.TimeSeriesInsights/environments/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[variables('resourceDiagName')]",
                        "location": "[variables('location')]",
                        "dependsOn": [],
                        "properties": {
                          "workspaceId": "[variables('logAnalytics')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": true,
                              "retentionPolicy": {
                                "days": 0,
                                "enabled": false
                              },
                              "timeGrain": null
                            }
                          ],
                          "logs": []
                        }
                      }
                    ],
                    "outputs": {}
                  },
                  "parameters": {
                    "logAnalytics": {
                      "value": "[variables('logAnalytics')]"
                    },
                    "location": {
                      "value": "[variables('locationField')]"
                    },
                    "resourceName": {
                      "value": "[variables('resourceNameField')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policySetDefinitions",
      "name": "[variables('diagafcInitiativeName')]",
      "apiVersion": "2018-05-01",
      "dependsOn": [
        "[variables('timeSeriesInsightsafcDiagPolicyName')]"
      ],
      "properties": {
        "displayName": "[afc] Deploy Diagnostic Settings for Azure Resources",
        "description": "This afc initiative configures Azure resources to forward diagnostic logs and metrics to an Azure Log Analytics workspace.",
        "metadata": {
          "category": "Azure Foundation Control"
        },
        "parameters": {
          "logAnalytics": {
            "type": "string",
            "metadata": {
              "displayName": "Log Analyitcs workspace",
              "description": "Select the Log Analytics workspace from dropdown list",
              "strongType": "omsWorkspace"
            }
          }
        },
        "policyDefinitions": [
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('nicafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('aaafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('pipafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('lbafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('nsgafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('kvafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('cognitiveafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('dataLakeAnalyticsafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('dataLakeStoreafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('eventHubafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('iotHubafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('logicAppsWorkflowafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('logicAppsIntegrationAccountsafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('recoveryVaultafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('searchServicesafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('serviceBusafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('sqlDBsafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('sqlElasticPoolsafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('apiMgmtafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('appGwafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('batchafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('mySQLafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('postgreSQLafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('cdnEndpointsafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('cosmosDBsafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('dataFactoryafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('firewallafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('powerBIEmbeddedafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('streamAnalyticsafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('expressRoutesafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('aciafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('acrafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('vnetafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('vmafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('vmssafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('vnetGWafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('aksafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('websiteafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('analysisServiceafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('eventGridTopicafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('eventGridSubafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('hdInsightafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('redisCacheafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('relayafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('signalRafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('trafficManagerafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('webServerFarmafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('sqlMIafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', variables('timeSeriesInsightsafcDiagPolicyName'))]",
            "parameters": {
              "logAnalytics": {
                "value": "[variables('logAnalytics')]"
              }
            }
          }
        ]
      }
    }
  ],
  "outputs": {}
}
